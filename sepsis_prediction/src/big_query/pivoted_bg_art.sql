select icustay_id, DATETIME_TRUNC(charttime,HOUR) charttime, avg(SPECIMEN_PROB) SPECIMEN_PROB,	
avg(SO2) SO2,
avg(spo2) spo2,	
avg(PO2) PO2,	
avg(PCO2) PCO2,	
avg(fio2_chartevents) fio2_chartevents ,	
avg(FIO2) FIO2,	
avg(AADO2) AADO2	,	
avg(AADO2_calc) AADO2_calc,	
avg(PaO2FiO2Ratio	) PaO2FiO2Ratio,
avg(PH) PH,	
avg(BASEEXCESS) BASEEXCESS,	
avg(BICARBONATE) BICARBONATE,	
avg(TOTALCO2) TOTALCO2,	
avg(HEMATOCRIT	) HEMATOCRIT	,
avg(HEMOGLOBIN	) HEMOGLOBIN,	
avg(CARBOXYHEMOGLOBIN)	CARBOXYHEMOGLOBIN,
avg(METHEMOGLOBIN) METHEMOGLOBIN,	
avg(CHLORIDE) CHLORIDE	,	
avg(CALCIUM) CALCIUM,	
avg(TEMPERATURE) TEMPERATURE,
avg(POTASSIUM) POTASSIUM,	
avg(SODIUM) SODIUM,	
avg(LACTATE) LACTATE,	
avg(GLUCOSE) GLUCOSE,	
avg(INTUBATED) INTUBATED	,
avg(TIDALVOLUME) TIDALVOLUME,
avg(VENTILATIONRATE	) VENTILATIONRATE,	
avg(VENTILATOR) VENTILATOR,	
avg(PEEP) PEEP,	
avg(O2Flow) O2Flow,	
avg(REQUIREDO2) REQUIREDO2
from `physionet-data.mimiciii_derived.pivoted_bg_art` as pv
group by icustay_id, DATETIME_TRUNC(charttime,HOUR)